{% extends "components/base.html" %}
{% load static %}

{% block head %}
  <title>{{ product.meta_title }}</title>
  <meta name="description" content="{{ product.meta_description }}">
  {% if product.seo_keywords %}
    <meta name="keywords" content="{{ product.seo_keywords }}">
  {% endif %}
  {% if product.meta_canonical %}
    <link rel="canonical" href="{{ product.meta_canonical }}">
  {% endif %}
{% endblock %}


<script type="application/ld+json">
{
  "@context": "https://schema.org/",
  "@type": "Product",
  "name": "{{ product.name|escapejs }}",
  "image": [
    "{{ product.image.url|default_if_none:'' }}"
  ],
  "description": "{{ product.short_description|striptags|escapejs }}",
  "sku": "{{ product.slug|escapejs }}",
  "brand": {
    "@type": "Brand",
    "name": "Raveon Technologies"
  },
  "manufacturer": {
    "@type": "Organization",
    "name": "Raveon Technologies",
    "url": "https://www.raveon.com"
  },
  "offers": {
    "@type": "Offer",
    "url": "{{ request.build_absolute_uri }}",
    "priceCurrency": "USD",
    "availability": "https://schema.org/InStock"
  },
  "url": "{{ request.build_absolute_uri }}"
}
</script>


{% block content %}
<style>
.ckeditor-content a {
  color: #1a76e7; /* Tailwind blue-500 */
}
.ckeditor-content a:hover {
  color: #b63c03; /* Tailwind yellow-500 */
  text-decoration: underline;
}
</style>


<div class="ckeditor-content max-w-6xl mx-auto p-6">
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": "https://www.raveon.com/"
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": "{{ product.category.name|escapejs }}",
      "item": "{{ request.scheme }}://{{ request.get_host }}{% url 'products:category_detail' product.category.id %}"
    },
    {
      "@type": "ListItem",
      "position": 3,
      "name": "{{ product.name|escapejs }}",
      "item": "{{ request.build_absolute_uri }}"
    }
  ]
}
</script>

  <!-- Product Header -->
  <div class="bg-white shadow-lg rounded-xl overflow-hidden">
    {% if product.image %}
      <img src="{{ product.image.url }}" alt="{{ product.name }}"
           class="w-50 h-50 object-cover mx-auto">
    {% endif %}

    <div class="p-6">
      <h1 class="text-3xl font-bold text-primary">{{ product.name }}</h1>
      <p class="mt-2 text-gray-600">{{ product.short_description }}</p>

      {% if product.category %}
        <span class="inline-block mt-3 px-3 py-1 bg-indigo-100 text-indigo-700 text-sm rounded-full">
          {{ product.category }}
        </span>
      {% endif %}
    </div>
  </div>

  <!-- Main Description -->
  {% if product.description %}
  <div class="mt-8 bg-white shadow rounded-xl p-6">
    <h2 class="text-2xl font-semibold text-primary mb-4">Overview of {{ product.name }}  </h2>
    <div class="prose max-w-none">
      {{ product.description|safe }}
    </div>
 
  {% endif %}

  <!-- Sections -->
  {% if product.section_1 %}
  
    <div class="prose max-w-none mt-6">
      {{ product.section_1|safe }}
    </div>
 
  {% endif %}
  
  {% if product.image_1 %}
  <div class="mt-8">
    <img src="{{ product.image_1.url }}" alt="Section 1 image"
         class="w-full rounded-xl shadow-md">
    {% if product.caption_1 %}
      <p class="text-sm text-gray-500 mt-2 text-center">{{ product.caption_1 }}</p>
    {% endif %}
  </div>
  {% endif %}

  {% if product.section_2 %}
 
    <div class="prose max-w-none mt-6">
      {{ product.section_2|safe }}
    </div>
 
  {% endif %}
  
  {% if product.image_2 %}
  <div class="mt-8">
    <img src="{{ product.image_2.url }}" alt="Section 2 image"
         class="w-full rounded-xl shadow-md">
    {% if product.caption_2 %}
      <p class="text-sm text-gray-500 mt-2 text-center">{{ product.caption_2 }}</p>
    {% endif %}
  </div>
  {% endif %}

  {% if product.section_3 or product.image_3 %}

      <div class="prose max-w-none mt-6">
        {{ product.section_3|safe }}
      </div>
   
    {% if product.image_3 %}
      <img src="{{ product.image_3.url }}" alt="Section 3 image"
           class="rounded-xl shadow-md">
      {% if product.caption_3 %}
        <p class="text-sm text-gray-500 mt-2 text-center">{{ product.caption_3 }}</p> 
    {% endif %}
  </div>
  {% endif %}
  {% endif %}

{% if product.general_features or product.specifications or product.downloads or product.accessories %}
  <!-- Full-width section -->
<section class="w-full bg-primary rounded-xl p-6 px-4">
  <div class="max-w-4xl mx-auto">
    <div x-data="{ tab: 'features' }" class="bg-white shadow-lg rounded-2xl p-6">

      <!-- Tab Buttons -->
      <div class="flex border-b border-gray-200">
        <button @click="tab = 'features'" 
                :class="tab === 'features' ? 'border-indigo-500 text-indigo-600' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'"
                class="w-1/4 py-2 text-center border-b-2 font-medium text-sm">
          General Features
        </button>
        <button @click="tab = 'specs'"
                :class="tab === 'specs' ? 'border-indigo-500 text-indigo-600' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'"
                class="w-1/4 py-2 text-center border-b-2 font-medium text-sm">
          Specifications
        </button>
        <button @click="tab = 'downloads'"
                :class="tab === 'downloads' ? 'border-indigo-500 text-indigo-600' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'"
                class="w-1/4 py-2 text-center border-b-2 font-medium text-sm">
          Downloads
        </button>
        <button @click="tab = 'accessories'"
                :class="tab === 'accessories' ? 'border-indigo-500 text-indigo-600' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'"
                class="w-1/4 py-2 text-center border-b-2 font-medium text-sm">
          Accessories
        </button>
      </div>

      <!-- Tab Panels -->
      <div class="mt-6">
        <!-- General Features -->
        <div x-show="tab === 'features'" class="prose max-w-none">
          {{ product.general_features|safe }}
        </div>

        <!-- Specifications -->
        <div x-show="tab === 'specs'" class="prose max-w-none">
          {{ product.specifications|safe }}
        </div>

        <!-- Downloads -->
        <div x-show="tab === 'downloads'" class="prose max-w-none">
          {{ product.downloads|safe }}
        </div>

        <!-- Accessories -->
        <div x-show="tab === 'accessories'" class="prose max-w-none">
          {{ product.accessories|safe }}
        </div>
      </div>

    </div>
  </div>
</section>
{% endif %}
  <!-- Related Products -->
 {% if related %}
  <h2 class="mt-12 text-xl font-semibold text-gray-900 dark:text-white">Related {{ product.category.name }} Products</h2>
  <div class="mt-4 grid gap-6 sm:grid-cols-2 lg:grid-cols-4">
    {% for p in related %}
      <a href="{% url 'products:detail' p.slug %}" class="overflow-hidden rounded-xl bg-white ring-1 ring-black/5 hover:shadow-md transition dark:bg-gray-900 dark:ring-white/10">
        <div class="aspect-[4/3] bg-gray-50 dark:bg-gray-800">
          {% if p.image %}
            <img src="{{ p.image.url }}" alt="{{ p.name }}" class="h-full w-full object-cover">
          {% else %}
            <div class="flex h-full w-full items-center justify-center text-gray-400">No Image</div>
          {% endif %}
        </div>
        <div class="p-3">
          <div class="flex items-center justify-between">
            <div class="font-medium text-primary dark:text-white">{{ p.name }}
            <p class="text-sm font-semibold text-amber-700">{{ p.short_description }}</p>
              </div>
          </div>
        </div>
      </a>
    {% endfor %}
  </div>
  {% endif %}
</div>
{% endblock content %}
